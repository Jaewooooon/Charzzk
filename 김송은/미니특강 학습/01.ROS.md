
# 01. ROS

- 로봇 개발에 필요한 필수적인 라이브러리 제공

![image.png](image%20(5).png)

![image.png](./image%20(6).png)

# ROS 용어

- 노드 : ROS에서 최소 단위의 실행 프로세스를 가리킴
    - 스크립트 = 노드
- 메시지 : 노드에서 노드로 정보를 전달하는 단방향, 비동기식, 연속성 통신
    - 토픽을 통해서 메시지 전달
- 패키지 : ROS SW의 기본 단위
    - 노드, 라이브러리, 환경설정 파일을 통합하는 최소 빌드/배포 단위

![image.png](./image%20(7).png)

# ROS 명령어

- 새로운 터미널 사용할 때마다 **항상** 배치파일 call
- 빌드가 성공적으로 완료되었으면, 설치된 패키지를 사용할 수 있도록 환경 설정 파일을 소스

```bash
# ros2 명령어를 사용하기 위함
$ call C:\dev\ros2-windows\setup.bat  

# workspace의 패키지 사용 위함
$ call C:\Users\SSAFY\Desktop\catkin_ws\install\setup.bat
```

## 노드 명령어

```bash
$ ros2 node list # 실행되고 있는 노드 이름 출력
$ ros2 node info /talker  # talker 노드의 통신 상태, 내용 출력

# 노드 실행
$ ros2 run my_package my_node 
```

## 토픽(메시지) 명령어

```bash
$ ros2 topic list  # publish 되고있는 메시지 리스트 출력
$ ros2 topic echo /chatter  # /chater의 메시지 내용 출력
$ ros2 topic pub /test std_msgs/msg/Float64 "{data : 10}"  # /test라는 메시지 publish
```

## 패키지 명령어

```bash
# 패키지 생성
# 패키지명 : my_package // 노드명 : my_node
$ ros2 pkg create --build-type ament_python --node-name my_node my_package 

# 빌드
# Native Tools Command Prompt VS 201x에서 진행
$ cd C:\Users\user\Desktop\catkin_ws
$ colcon build
```

# ROS 장점

- 노드 간 메시지 교환 방법으로 기능별로 프로그램을 나눠 공동 개발에 이용
- 로봇 관련 패키지 제공
- 시각화 도구: RQT, RVIZ
- 메시지 기록/재생도구: ROSBAG

# ROS 실습

## 노드 만들기: talker

- 튜토리얼 제공 코드 (`src\my_package\my_package\publisher_member_function.py` 로 저장)
    
    https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html
    
- `src\my_package\[setup.py](http://setup.py) → talker = my_package.publisher_member_function:main` 추가
- 빌드 (`$ colcon build`)
- 노드 실행 (`$ ros2 run my_package talker`)

## 노드 만들기: listener

- 상기와 동일 방법으로

## 시각화

- rqt 실행 (`$rqt`)
- publish 되고 있는 토픽 모니터링 가능
    
    ![image.png](./image%20(8).png)
    

## Launch file

- 여러 개의 노드를 한 번에 켤 수 있도록 작성된 스크립트
- `src\my_package\launch\test_launch.py`
    
    ```python
    from launch import LaunchDescription
    from launch_ros.actions import Node
    
    def generate_launch_description():
        return LaunchDescription([
            Node(
                package='my_package',
                node_executable='talker',
                node_name='talker',
                output='screen'
            ),
            Node(
                package='my_package',
                node_executable='listener',
                node_name='listener',
                output='screen'
            )
    
        ])
    ```
    
- 실행
    - launch 파일이 있는 곳으로 이동
    - `$ ros2 launch test_launch.py`
